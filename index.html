<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uber Driver Profit Calculator</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Uber Driver Profit Calculator</h1>
            <p>Track your earnings and expenses to calculate real profit</p>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="earnings">Earnings</button>
            <button class="tab-btn" data-tab="expenses">Expenses</button>
            <button class="tab-btn" data-tab="mileage">Mileage</button>
            <button class="tab-btn" data-tab="config">Settings</button>
            <button class="tab-btn" data-tab="summary">Summary</button>
        </nav>

        <!-- Earnings Tab -->
        <div id="earnings" class="tab-content active">
            <h2>Add Daily Earnings</h2>
            <form id="earningsForm">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="earningsDate" required>
                </div>
                <div class="form-group">
                    <label>Total Ride Distance (km)</label>
                    <input type="number" id="grossFare" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Total Income (LKR)</label>
                    <input type="number" id="commission" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Number of Trips</label>
                    <input type="number" id="tripCount" value="1" required>
                </div>
                <button type="submit" class="btn-primary">Add Earnings</button>
            </form>

            <h2>Earnings Records</h2>
            <div class="table-wrapper">
                <table id="earningsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Distance (km)</th>
                            <th>Income (LKR)</th>
                            <th>Trips</th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Expenses Tab -->
        <div id="expenses" class="tab-content">
            <h2>Add Expense</h2>
            <form id="expenseForm">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="expenseCategory" required>
                        <option value="">-- Select Category --</option>
                        <option value="fuel">Fuel</option>
                        <option value="parking">Parking</option>
                        <option value="tolls">Tolls</option>
                        <option value="carwash">Car Wash</option>
                        <option value="insurance">Insurance</option>
                        <option value="lease">Lease/Loan</option>
                        <option value="license">Vehicle License</option>
                        <option value="internet">Internet</option>
                        <option value="maintenance">Maintenance</option>
                        <option value="repairs">Repairs</option>
                        <option value="tires">Tires</option>
                        <option value="battery">Battery</option>
                        <option value="engine">Engine Work</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount (LKR)</label>
                    <input type="number" id="expenseAmount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="expenseType" required>
                        <option value="variable">Variable</option>
                        <option value="fixed">Fixed</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Odometer (km) <span class="optional">(optional)</span></label>
                    <input type="number" id="expenseOdometer" step="0.1">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <input type="text" id="expenseNotes" placeholder="e.g., 4 new tires">
                </div>
                <button type="submit" class="btn-primary">Add Expense</button>
            </form>

            <h2>Expense Records</h2>
            <div class="table-wrapper">
                <table id="expenseTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Type</th>
                            <th>Notes</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Mileage Tab -->
        <div id="mileage" class="tab-content">
            <h2>Daily Mileage Tracking</h2>
            <form id="mileageForm">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="mileageDate" required>
                </div>
                <div class="form-group">
                    <label>Odometer Start (km)</label>
                    <input type="number" id="odometerStart" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Odometer End (km)</label>
                    <input type="number" id="odometerEnd" step="0.1" required>
                </div>
                <button type="submit" class="btn-primary">Add Mileage</button>
            </form>

            <h2>Mileage Records</h2>
            <div class="table-wrapper">
                <table id="mileageTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Start (km)</th>
                            <th>End (km)</th>
                            <th>Distance (km)</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="config" class="tab-content">
            <h2>Commute & Cost Settings</h2>
            <form id="configForm">
                <div class="form-group">
                    <label>Driver Pass Cost per Day (LKR)</label>
                    <input type="number" id="driverPassCostPerDay" step="0.01" value="999" required>
                </div>
                <div class="form-group">
                    <label>Driver Pass Activation Date</label>
                    <input type="date" id="driverPassActivationDate" required>
                </div>
                <div class="form-group">
                    <label>Fuel Consumption Rate (km/liter)</label>
                    <input type="number" id="fuelConsumptionRate" step="0.1" value="13" required>
                </div>
                <div class="form-group">
                    <label>Fuel Price per Liter (LKR)</label>
                    <input type="number" id="fuelPricePerLiter" step="0.01" value="250" required>
                </div>
                <div class="form-group">
                    <label>Maintenance Cost per KM (LKR) <span class="optional">Typical: 8-15 per km</span></label>
                    <input type="number" id="maintenanceCost" step="0.01" value="10" required>
                </div>
                <button type="submit" class="btn-primary">Save Settings</button>
            </form>

            <div class="danger-zone">
                <h3>Danger Zone</h3>
                <p>Clear all saved data including earnings, expenses, and settings.</p>
                <button id="clearStorageBtn" class="btn-delete">Clear All Data</button>
            </div>
        </div>

        <!-- Summary Tab -->
        <div id="summary" class="tab-content">
            <h2>Monthly Profit & Loss Statement</h2>
            
            <div class="summary-filters">
                <label>Month & Year:</label>
                <input type="month" id="summaryMonth">
            </div>

            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Ride Income</h3>
                    <p class="summary-value" id="totalRevenue">LKR 0.00</p>
                </div>
                <div class="summary-card">
                    <h3>Total Costs</h3>
                    <p class="summary-value expense" id="totalExpenses">LKR 0.00</p>
                </div>
                <div class="summary-card">
                    <h3>True Net Profit</h3>
                    <p class="summary-value" id="netProfit">LKR 0.00</p>
                </div>
                <div class="summary-card">
                    <h3>Profit Margin</h3>
                    <p class="summary-value" id="profitMargin">0%</p>
                </div>
            </div>

            <div class="summary-section">
                <h3>Cost Breakdown</h3>
                <div id="expenseBreakdown" class="breakdown-table"></div>
            </div>

            <div class="summary-section">
                <h3>Key Metrics</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <label>Total KM</label>
                        <p id="totalKm">0 km</p>
                    </div>
                    <div class="metric-card">
                        <label>Cost per KM</label>
                        <p id="costPerKm">LKR 0.00</p>
                    </div>
                    <div class="metric-card">
                        <label>Profit per KM</label>
                        <p id="profitPerKm">LKR 0.00</p>
                    </div>
                    <div class="metric-card">
                        <label>Profit per Day</label>
                        <p id="hourlyProfit">LKR 0.00 / day</p>
                    </div>
                </div>
            </div>

            <div class="export-section">
                <button id="exportEarnings" class="btn-secondary">Export Earnings (CSV)</button>
                <button id="exportExpenses" class="btn-secondary">Export Expenses (CSV)</button>
                <button id="exportSummary" class="btn-secondary">Export Summary (CSV)</button>
            </div>

            <div class="import-section">
                <h3>Import Data</h3>
                <p>Restore your earnings or expenses from exported CSV files.</p>
                <button id="importEarningsBtn" class="btn-secondary">Import Earnings (CSV)</button>
                <button id="importExpensesBtn" class="btn-secondary">Import Expenses (CSV)</button>
                <input type="file" id="importEarningsFile" accept=".csv" style="display: none;">
                <input type="file" id="importExpensesFile" accept=".csv" style="display: none;">
            </div>
        </div>
    </div>

    <!-- Edit Modals -->
    
    <!-- Edit Earnings Modal -->
    <div id="editEarningsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="UI.closeModal('editEarningsModal')">&times;</span>
            <h2>Edit Earnings</h2>
            <form id="editEarningsForm">
                <input type="hidden" id="editEarningsId">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="editEarningsDate" required>
                </div>
                <div class="form-group">
                    <label>Total Ride Distance (km)</label>
                    <input type="number" id="editGrossFare" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Total Income (LKR)</label>
                    <input type="number" id="editCommission" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Number of Trips</label>
                    <input type="number" id="editTripCount" value="1" required>
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Edit Expense Modal -->
    <div id="editExpenseModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="UI.closeModal('editExpenseModal')">&times;</span>
            <h2>Edit Expense</h2>
            <form id="editExpenseForm">
                <input type="hidden" id="editExpenseId">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="editExpenseDate" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="editExpenseCategory" required>
                        <option value="">-- Select Category --</option>
                        <option value="fuel">Fuel</option>
                        <option value="parking">Parking</option>
                        <option value="tolls">Tolls</option>
                        <option value="carwash">Car Wash</option>
                        <option value="insurance">Insurance</option>
                        <option value="lease">Lease/Loan</option>
                        <option value="license">Vehicle License</option>
                        <option value="internet">Internet</option>
                        <option value="maintenance">Maintenance</option>
                        <option value="repairs">Repairs</option>
                        <option value="tires">Tires</option>
                        <option value="battery">Battery</option>
                        <option value="engine">Engine Work</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount (LKR)</label>
                    <input type="number" id="editExpenseAmount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="editExpenseType" required>
                        <option value="variable">Variable</option>
                        <option value="fixed">Fixed</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Odometer (km) <span class="optional">(optional)</span></label>
                    <input type="number" id="editExpenseOdometer" step="0.1">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <input type="text" id="editExpenseNotes" placeholder="e.g., 4 new tires">
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Edit Mileage Modal -->
    <div id="editMileageModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="UI.closeModal('editMileageModal')">&times;</span>
            <h2>Edit Mileage</h2>
            <form id="editMileageForm">
                <input type="hidden" id="editMileageId">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="editMileageDate" required>
                </div>
                <div class="form-group">
                    <label>Odometer Start (km)</label>
                    <input type="number" id="editOdometerStart" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Odometer End (km)</label>
                    <input type="number" id="editOdometerEnd" step="0.1" required>
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/calculations.js"></script>
    <script src="js/export.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

